# Realtime Santa's factory
*Automate the Santa's factory &amp; learn Java, TestNG and Mockito*

Рождество близко и фабрика Санты работает на полную мощность.

В почтовый ящик Санты приходит два типа писем - письма от детей с просьбами о подарках и сообщения от осведомителей. Специальный эльф занимается диспетчеризацией корреспонденции. Письма детей он приносит Санте, сообщения осведомителей перенаправляет в департамент подарочного скоринга (ДПС), а реклама консервированной ветчины и прочая ерунда отправляется в спам.

В ДПС эльфы ищут досье соответствующего ребенка и если не находят, то создают новое. В досье есть два типа записей - плохие и хорошие дела. Эльфы пытаются сопоставить событие из письма осведомителя с реестрами хороших и плохих дел, и если находят соответствующую запись, то вносят запись в досье.

Письма детей приходят Санте. Санта обращается в департамент подарочного скоринга за соответствующим досье ребенка. Если подарочный скоринг из досье (разница между количеством хороших и плохих дел) больше нуля, то Санта отправляет на фабрику заказ с указанием имени ребенка. Если же досье отсутствует или скоринг равен нулю, то Санта логгирует "Хохохо" и с вероятностью 0.5 все-таки отправляет заказ на изготовление подарка. Также если нужен подарок, но на складе Санты есть уже нужный подарок, то ему назначается имя ребенка и заказ на фабрику не отправляется.

На фабрике Санты 5 эльфов параллельно изготавливают подарки, в конце концов прилепляя имя ребенка на готовый подарок и отправляя его на склад. Если все эльфы заняты, то заказы формируют очередь.

Поскольку фабрика Санты realtime, то бизнес-процессы чутко реагируют на последние события. Для борьбы с жульничеством и погромами в канун Рождеcтва эльфы в ДПС сообщают Санте о изменении скоринга в отрицательную сторону (т.е. когда балл становится меньше нуля). При поступлении уведомления Санта оценивает величину отрицательного балла - если он "-1", то Санта с вероятностью 0.5 логгирует "Хохохо" и не отменяет подарка. В ином же случае и если балл меньше -1, Санта отменяет заказ на фабрике или же срывает бирку с именем ребенка с подарка на складе (и этот подарок может потом достаться кому-то еще).

Реализуйте фабрику Санты с использованием лучших практик - инверсии зависимостей, юнит-тестирования и принципа единственной зависимости. По возможности, используйте многопоточность.
